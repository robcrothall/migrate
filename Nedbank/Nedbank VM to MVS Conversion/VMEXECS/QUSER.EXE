&TRACE
&IF &N = 0 &EXIT
STATE USER DIRECT *
&IF &RC = 0 &GOTO -FIND
MAKEBUF
&BUF = &RC
&ERROR &EXIT
GETFMADR
&READ VARS &AST &MODE &ADR
DROPBUF &BUF
CP LINK DIRMAINT 195 &ADR RR  KITKAT
&STACK LIFO CP DETACH &ADR
AC &ADR &MODE
&STACK LIFO RELEASE &MODE
-FIND
&ERROR
MAKEBUF
&BUF = &RC
&C = 1
&LOOP -ENDLOOP1 &N
&START = 0
-LOCATE
EXECIO * DISKR USER DIRECT * (FI / &&C / ZONE 5 17
&IF &RC = 0 &GOTO -TESTIT
&TYPE USER &&C NOT IN DIRECTORY
&GOTO -BUMP
-TESTIT
&READ VARS &RELATIVE &ACTUAL
&IF .&ACTUAL = . &START = &START + &RELATIVE
&IF .&ACTUAL NE . &START = &ACTUAL
&READ STRING &S
& = 0 - 1 + &LOCATION OF &&C &S
& = &PIECE OF &S 1 &
&STACK LIFO &
&READ VARS &U
&IF &U NE USER &IF &U NE U &GOTO -LOCATE
& = &START + 1
EXECIO * DISKR USER DIRECT * & (FIND /USER /
&IF &RC = 0 &GOTO -SETRANGE
EXECIO * DISKR USER  DIRECT * & (FIND /U /
&IF &RC = 0 &GOTO -SETRANGE
&STACK LIFO DUMMY USER RECORD
&STACK LIFO *
-SETRANGE
&READ VARS &RANGE
&READ VARS &JUNK
EXECIO &RANGE DISKR USER  DIRECT * &START (FINIS MARGIN 1 72
&IF &C = 1 &COMMAND CLRSCR
&LOOP 2 &RANGE
&READ STRING &S
&TYPE &S
&TYPE
-BUMP
&C = &C + 1
-ENDLOOP1
DROPBUF &BUF
&EXIT
